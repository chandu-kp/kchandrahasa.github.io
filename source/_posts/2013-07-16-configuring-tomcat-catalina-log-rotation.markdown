---
layout: post
title: "Configuring Tomcat Catalina Log Rotation"
date: 2013-07-16 01:23
comments: true
author: Chandra
categories: tomcat catalina log rotation java
---
Tomcat uses Juli logging package for all system level logging by default. Tomcat 6.0 onwards Juli is basically a wrapper over java.util.logging.

Here are the important log files generated by Tomcat

- catalina.out : all sysout and syserr goes into this log along with the bootstrap logs from when you start/stop Tomcat
- catalina.YYYY-MM-DD.log : This, as you can see, a daily rotating file with all sysout, syserr logs.
<!--more-->
Problem with catalina.out
-------------------------
*catalina.out* by default does not rotate. It can grow till you run out of space. This can potentially be issue if your webapp is logging to sysout, which ideally should not be the case and instead use its own logger preferably using log4j or using java.util.logging itself.

But in some cases, you may be deploying someone else's the web application. So, you may need to either keep truncating catalina.out or turn off logging. Please note that truncating/deleting the catalina.out needs Tomcat restart to take effect.

#### The simplest way of turning off catalina.out is as follows:
- go to *logging.properties* and modify as follows (either way)

Turn off log level for *java.util.logging.ConsoleHandler*

{% gist 6005716 %}
  
OR

remove *java.util.logging.ConsoleHandler* altogether

{% gist 6005738 %}
 > logging.properties is located in <CATALINA_HOME>/conf or /etc/tomcat6

Problem with daily log files
----------------------------
The daily log files, catalina.YYYY-MM-DD.log, rotate once a day by default. This again may cause issue depending on the web app, if the web app is receiving millions of request daily or its logging lots of logs. So, you may need to rotate this log as well to keep the size limit in check. Juli by do not have rotating capability other than daily rotation. Instead change the logging package from Juli to java.uitl.logging as follows in order to rotate the log.
> In case you need to turn off this log as well, you can do so similar to catalina.out as mentioned above.

  {% gist 6005771 %}

Why application log goes to catalina logs?
------------------------------------------
Even though you use logging framework, the log may still be going to catalina logs along with your own log files. This is mostly due to the way logger has been set up in that the log is added to console handler as well in addition to file handler. Anything that is added to console handler is redirected to catalina logs unless they are turned off as mentioned above. 

If you are using java.util.logging in your web application, then you can turn off logging to console handler using ``logger.setUseParentHandlers(false);`` 
> For more details refer: http://stackoverflow.com/a/2533250/674446 

If you are using log4j, make sure you do not have, ``org.apache.log4j.ConsoleAppender`` in log4j.properties, instead use only ``org.apache.log4j.RollingFileAppender``.
